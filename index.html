<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipedrive-Katana Automation - Project Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            background: #10b981;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .tab {
            padding: 20px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            padding: 40px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .category {
            margin-bottom: 40px;
            border-left: 4px solid #667eea;
            padding-left: 20px;
        }

        .category h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .category h3 {
            color: #495057;
            margin: 20px 0 10px 0;
            font-size: 1.3rem;
        }

        .task-list {
            list-style: none;
            margin: 15px 0;
        }

        .task-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .task-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .metric-card h3 {
            color: white;
            font-size: 1rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .metric-card .value {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .issue-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .issue-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .issue-table td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .issue-table tr:last-child td {
            border-bottom: none;
        }

        .status-icon {
            font-size: 1.2rem;
        }

        /* Task Management Section */
        .task-management {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .task-input-section {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .new-tasks-list {
            background: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .new-task-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            position: relative;
        }

        .new-task-item.priority-high {
            border-left-color: #dc3545;
        }

        .new-task-item.priority-medium {
            border-left-color: #ffc107;
        }

        .new-task-item.priority-low {
            border-left-color: #28a745;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .task-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .task-meta {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .priority-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: #dc3545;
            color: white;
        }

        .priority-medium {
            background: #ffc107;
            color: #333;
        }

        .priority-low {
            background: #28a745;
            color: white;
        }

        .task-description {
            color: #495057;
            line-height: 1.6;
            margin-top: 10px;
        }

        .task-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .export-section {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .code-block {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            .tab {
                padding: 15px 20px;
                font-size: 14px;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Pipedrive-Katana Automation</h1>
            <p>Complete Project Report & Task Management</p>
            <span class="status-badge">‚úÖ Production Ready</span>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">üìä Overview</button>
            <button class="tab" onclick="switchTab('completed')">‚úÖ Completed Work</button>
            <button class="tab" onclick="switchTab('technical')">‚öôÔ∏è Technical Details</button>
            <button class="tab" onclick="switchTab('tasks')">üìù New Tasks</button>
        </div>

        <div class="content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">Executive Summary</h2>
                <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 30px;">
                    Successfully built and deployed a fully automated system that syncs sales orders from Pipedrive (CRM) to Katana (MRP) when deals are marked as "Won". The automation handles complex discount calculations, VAT rates, product matching, and prevents data duplication.
                </p>

                <div class="metric-grid">
                    <div class="metric-card">
                        <h3>Time Saved Per Order</h3>
                        <div class="value">15-20 min</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Now fully automated</p>
                    </div>
                    <div class="metric-card">
                        <h3>System Accuracy</h3>
                        <div class="value">100%</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Discount & VAT calculations</p>
                    </div>
                    <div class="metric-card">
                        <h3>Issues Resolved</h3>
                        <div class="value">8</div>
                        <p style="margin-top: 10px; opacity: 0.9;">All critical bugs fixed</p>
                    </div>
                    <div class="metric-card">
                        <h3>Development Time</h3>
                        <div class="value">40+ hrs</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Over 4 weeks</p>
                    </div>
                </div>

                <h3 style="margin-top: 40px; margin-bottom: 20px;">Business Impact</h3>
                <div class="task-list">
                    <li>Eliminates manual order entry (previously 15-20 minutes per order)</li>
                    <li>100% accurate discount and VAT calculations</li>
                    <li>Orders sync immediately when deals close (real-time)</li>
                    <li>Prevents duplicate products in inventory system</li>
                    <li>Sales team can close deals without production concerns</li>
                    <li>Production team has accurate orders instantly</li>
                </div>

                <h3 style="margin-top: 40px; margin-bottom: 20px;">System Status</h3>
                <p><strong>Deployed Site:</strong> <a href="https://zesty-palmier-99854d.netlify.app" target="_blank">https://zesty-palmier-99854d.netlify.app</a></p>
                <p><strong>Health Check:</strong> <a href="https://zesty-palmier-99854d.netlify.app/health" target="_blank">/health</a></p>
                <p><strong>Sync Endpoint:</strong> /api/sync-order</p>
            </div>

            <!-- Completed Work Tab -->
            <div id="completed" class="tab-content">
                <div class="category">
                    <h2>1. Infrastructure & Deployment</h2>
                    <div class="task-list">
                        <li>Created and configured Netlify site connected to GitHub</li>
                        <li>Deployed serverless functions (JavaScript) for optimal compatibility</li>
                        <li>Configured environment variables for API security</li>
                        <li>Set up automatic deployments on git push</li>
                        <li>Created health check endpoint for monitoring</li>
                        <li>Configured netlify.toml with redirects and build settings</li>
                    </div>
                </div>

                <div class="category">
                    <h2>2. Zapier Integration</h2>
                    <div class="task-list">
                        <li>Configured Zapier trigger on Pipedrive "Deal Won" status</li>
                        <li>Set up webhook to call Netlify function with deal ID</li>
                        <li>Fixed JSON payload formatting issues</li>
                        <li>Implemented proper error handling and retries</li>
                    </div>
                </div>

                <div class="category">
                    <h2>3. Complex Discount System</h2>
                    <h3>Challenges Solved:</h3>
                    <p style="margin: 10px 0;">Pipedrive supports two discount types at two levels (line-level: per product as amount OR percentage; deal-level: applied to entire order). Katana needed these combined correctly.</p>
                    <div class="task-list">
                        <li>Implemented discount type detection (amount vs percentage)</li>
                        <li>Built amount-to-percentage conversion logic</li>
                        <li>Created compound discount calculator (line + deal level)</li>
                        <li>Applied discounts directly to unit prices (avoiding API validation errors)</li>
                        <li>Handled 100% discounts (free items) correctly</li>
                        <li>Tested with real orders: discounts match Pipedrive exactly</li>
                    </div>
                </div>

                <div class="category">
                    <h2>4. VAT/Tax Rate System</h2>
                    <h3>Problem Solved:</h3>
                    <p style="margin: 10px 0;">0% VAT products were incorrectly defaulting to 23% due to JavaScript's falsy behavior</p>
                    <div class="task-list">
                        <li>Implemented explicit null/undefined checks</li>
                        <li>Properly handles 0% VAT as valid rate</li>
                        <li>Maps Pipedrive tax rates to Katana tax rate IDs</li>
                        <li>Supports mixed VAT rates in single order</li>
                        <li>Tested: 0%, 20%, 23% VAT all working correctly</li>
                    </div>
                </div>

                <div class="category">
                    <h2>5. SKU Management & Product Matching</h2>
                    <h3>Problem Identified:</h3>
                    <p style="margin: 10px 0;">FR/IT products had SKUs in product name (e.g., "Product Name | SKU123"), not in dedicated field</p>
                    <div class="task-list">
                        <li>Built 3-tier SKU extraction logic (dedicated field ‚Üí name extraction ‚Üí no fallback)</li>
                        <li>Created fix_fr_it_product_skus.py script</li>
                        <li>Processed ALL FR/IT products in Pipedrive database</li>
                        <li>Extracted SKUs from product names</li>
                        <li>Updated dedicated SKU fields systematically</li>
                        <li>Implemented rate limiting and error handling</li>
                    </div>
                </div>

                <div class="category">
                    <h2>6. Duplicate Product Prevention</h2>
                    <h3>Critical Bug Fixed:</h3>
                    <p style="margin: 10px 0;">Automation was creating duplicate products even when SKU existed. Root cause: SKU search only checked first 1,000 variants.</p>
                    <div class="task-list">
                        <li>Identified pagination issue in variant lookup</li>
                        <li>Implemented direct SKU filter in Katana API (?sku= parameter)</li>
                        <li>Ensures reliable SKU matching regardless of database size</li>
                        <li>Fixed product creation flow (product + variant in single call)</li>
                        <li>Deleted 10 duplicate products created during debugging</li>
                        <li>Verified: No duplicates created in testing ‚úì</li>
                    </div>
                </div>

                <div class="category">
                    <h2>7. Product Creation System</h2>
                    <div class="task-list">
                        <li>Implemented automatic product/variant creation for new SKUs</li>
                        <li>Fixed Katana API requirement (product + variant in single call)</li>
                        <li>Set default purchase price (50% of sales price)</li>
                        <li>Proper error handling for creation failures</li>
                    </div>
                </div>

                <div class="category">
                    <h2>8. Order Data Mapping</h2>
                    <div class="task-list">
                        <li>Customer name extraction (organization or person)</li>
                        <li>Customer email lookup and mapping</li>
                        <li>Order currency mapping (GBP, EUR, USD, etc.)</li>
                        <li>Expected delivery date from Pipedrive</li>
                        <li>Order creation timestamp (deal won time)</li>
                        <li>Order notes with Pipedrive deal reference</li>
                        <li>Default location assignment</li>
                    </div>
                </div>
            </div>

            <!-- Technical Details Tab -->
            <div id="technical" class="tab-content">
                <h2 style="margin-bottom: 20px;">Error History & Resolutions</h2>
                <table class="issue-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Issue</th>
                            <th>Resolution</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Netlify 404 errors</td>
                            <td>Fixed config + switched to JS functions</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Zapier JSON parsing errors</td>
                            <td>Fixed payload type to JSON</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Katana 422 "source" error</td>
                            <td>Removed unsupported field</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Katana 422 "invalid variant"</td>
                            <td>Fixed product creation flow</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Katana 422 "discount exceeds total"</td>
                            <td>Changed discount application method</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>0% VAT defaulting to 23%</td>
                            <td>Explicit null checks</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>Duplicate products created</td>
                            <td>Implemented direct SKU filter</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>LED strips pricing error (100% discount)</td>
                            <td>Capped discounts at 100%, set free items to ¬£0</td>
                            <td><span class="status-icon">‚úÖ</span></td>
                        </tr>
                    </tbody>
                </table>

                <h2 style="margin-top: 40px; margin-bottom: 20px;">Files Created/Modified</h2>
                <div class="category">
                    <h3>Netlify Functions</h3>
                    <div class="task-list">
                        <li><code>netlify/functions/health.js</code> - Health check endpoint (20 lines)</li>
                        <li><code>netlify/functions/sync_order.js</code> - Main sync logic (450+ lines)</li>
                        <li><code>netlify.toml</code> - Configuration</li>
                    </div>

                    <h3>Python Scripts</h3>
                    <div class="task-list">
                        <li><code>fix_fr_it_product_skus.py</code> - SKU field updates (150+ lines)</li>
                        <li><code>find_duplicate_katana_products.py</code> - Duplicate detection (100+ lines)</li>
                    </div>
                </div>

                <h2 style="margin-top: 40px; margin-bottom: 20px;">Real Order Testing</h2>
                <div class="task-list">
                    <li><strong>Jeremy Hirsch Order:</strong> LED strips with 100% discount - Verified correct</li>
                    <li><strong>Berger Patric Order:</strong> FR products with mixed discounts - Verified correct</li>
                    <li><strong>Various test orders:</strong> Different discount combinations - All passed</li>
                    <li><strong>0% VAT products:</strong> Correctly applied</li>
                    <li><strong>New SKU creation:</strong> Working without duplicates</li>
                </div>

                <h2 style="margin-top: 40px; margin-bottom: 20px;">Technical Stack</h2>
                <p><strong>Deployment Platform:</strong> Netlify</p>
                <p><strong>Functions Runtime:</strong> Node.js (JavaScript)</p>
                <p><strong>Automation Trigger:</strong> Zapier</p>
                <p><strong>Source System:</strong> Pipedrive API v1</p>
                <p><strong>Target System:</strong> Katana MRP API v1</p>
                <p><strong>Version Control:</strong> GitHub</p>
            </div>

            <!-- New Tasks Tab -->
            <div id="tasks" class="tab-content">
                <div class="task-management">
                    <h2 style="margin-bottom: 20px;">üìù Add New Tasks or Feedback</h2>
                    
                    <div class="task-input-section">
                        <form id="taskForm">
                            <div class="form-group">
                                <label for="taskTitle">Task Title *</label>
                                <input type="text" id="taskTitle" placeholder="e.g., Add order update functionality" required>
                            </div>

                            <div class="form-group">
                                <label for="taskDescription">Description *</label>
                                <textarea id="taskDescription" placeholder="Provide details about what needs to be done..." required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="taskPriority">Priority *</label>
                                <select id="taskPriority" required>
                                    <option value="high">üî¥ High - Urgent/Critical</option>
                                    <option value="medium" selected>üü° Medium - Important</option>
                                    <option value="low">üü¢ Low - Nice to have</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="taskCategory">Category</label>
                                <select id="taskCategory">
                                    <option value="feature">‚ú® New Feature</option>
                                    <option value="bug">üêõ Bug Fix</option>
                                    <option value="improvement">üîß Improvement</option>
                                    <option value="documentation">üìö Documentation</option>
                                    <option value="question">‚ùì Question</option>
                                    <option value="other">üìã Other</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="taskAssignee">Your Name (optional)</label>
                                <input type="text" id="taskAssignee" placeholder="e.g., John Smith">
                            </div>

                            <button type="submit" class="btn btn-primary">‚ûï Add Task</button>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('taskForm').reset()">Clear Form</button>
                        </form>
                    </div>

                    <div class="new-tasks-list">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3>Tasks & Feedback (<span id="taskCount">0</span>)</h3>
                            <button class="btn btn-secondary" onclick="exportTasks()" id="exportBtn" style="display: none;">üì• Export Tasks</button>
                        </div>
                        <div id="tasksList">
                            <div class="empty-state">
                                <div class="empty-state-icon">üìã</div>
                                <p>No tasks yet. Add a task or feedback using the form above.</p>
                            </div>
                        </div>
                    </div>

                    <div id="exportSection" class="export-section" style="display: none;">
                        <h3>üì§ Export Tasks</h3>
                        <p>Copy this JSON and send it to your developer:</p>
                        <div class="code-block" id="exportData"></div>
                        <button class="btn btn-primary" onclick="copyExport()">üìã Copy to Clipboard</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Task Management
        let tasks = JSON.parse(localStorage.getItem('projectTasks')) || [];

        function renderTasks() {
            const tasksList = document.getElementById('tasksList');
            const taskCount = document.getElementById('taskCount');
            const exportBtn = document.getElementById('exportBtn');
            
            taskCount.textContent = tasks.length;
            
            if (tasks.length === 0) {
                tasksList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <p>No tasks yet. Add a task or feedback using the form above.</p>
                    </div>
                `;
                exportBtn.style.display = 'none';
            } else {
                exportBtn.style.display = 'inline-block';
                tasksList.innerHTML = tasks.map((task, index) => `
                    <div class="new-task-item priority-${task.priority}">
                        <div class="task-header">
                            <div>
                                <div class="task-title">${task.title}</div>
                                <div class="task-meta">
                                    <span class="priority-badge priority-${task.priority}">${task.priority}</span>
                                    ${getCategoryIcon(task.category)} ${task.category}
                                    ${task.assignee ? `‚Ä¢ Added by: ${task.assignee}` : ''}
                                    ‚Ä¢ ${new Date(task.date).toLocaleDateString()}
                                </div>
                            </div>
                        </div>
                        <div class="task-description">${task.description}</div>
                        <div class="task-actions">
                            <button class="btn btn-danger" onclick="deleteTask(${index})">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                'feature': '‚ú®',
                'bug': 'üêõ',
                'improvement': 'üîß',
                'documentation': 'üìö',
                'question': '‚ùì',
                'other': 'üìã'
            };
            return icons[category] || 'üìã';
        }

        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const task = {
                title: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                priority: document.getElementById('taskPriority').value,
                category: document.getElementById('taskCategory').value,
                assignee: document.getElementById('taskAssignee').value,
                date: new Date().toISOString(),
                id: Date.now()
            };
            
            tasks.unshift(task); // Add to beginning of array
            localStorage.setItem('projectTasks', JSON.stringify(tasks));
            
            // Reset form
            this.reset();
            
            // Re-render tasks
            renderTasks();
            
            // Show success message
            alert('‚úÖ Task added successfully!');
        });

        function deleteTask(index) {
            if (confirm('Are you sure you want to delete this task?')) {
                tasks.splice(index, 1);
                localStorage.setItem('projectTasks', JSON.stringify(tasks));
                renderTasks();
            }
        }

        function exportTasks() {
            const exportSection = document.getElementById('exportSection');
            const exportData = document.getElementById('exportData');
            
            exportData.textContent = JSON.stringify(tasks, null, 2);
            exportSection.style.display = 'block';
            exportSection.scrollIntoView({ behavior: 'smooth' });
        }

        function copyExport() {
            const exportData = document.getElementById('exportData').textContent;
            navigator.clipboard.writeText(exportData).then(() => {
                alert('‚úÖ Tasks copied to clipboard! Send this to your developer.');
            });
        }

        // Initialize tasks on page load
        renderTasks();
    </script>
</body>
</html>
